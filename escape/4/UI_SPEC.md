# 脱出ゲーム #4 UI仕様（実装用）

## 共通
- 画面下に常設:
  - インベントリ（アイテムを選択→「使用中」状態にできる）
  - ログ（最大6〜8件、最新が上）
  - ヒント（Lv0〜2を切替。世界観としては館内放送）
- モーダル:
  - どのモーダルでも `閉じる` / `戻る` を確実に提供
  - 入力系は全角数字/全角スペースを正規化

---

## シーン切替（実装優先の結論）
- UI上部/下部に「4画面タブ」方式（記録室/廊下/保管庫/洗面）
- 物語的な移動演出はログで補う（例:「廊下に出た。雨音が遠い。」）

---

## モーダル一覧

### 1) 引き出し棚（`modal: drawers`）
- 表示: 4×4グリッド（01〜16）
- 状態表示:
  - 未開封/開封済み
  - ロック種別（アイコン程度）
  - 赤フィルム所持時は「赤い数字」を確認できる導線（表示ON/OFF）
- 動作:
  - 引き出しをタップ→個別モーダルへ（`drawer-detail`）
  - 「記録を整列」ボタン→整列UI（15）

### 2) 引き出し個別（`modal: drawer-detail`）
- 表示: 引き出し番号、ロック入力（必要なら）、中身
- ロック入力:
  - `text`: ラベル穴埋め（2）…選択式 or 入力式
  - `code`: 数字入力（3/9/4/14）…2〜3桁想定
  - `condition`: 条件未達なら「引っかかって開かない」メッセージ
  - `hint`: 情報不足なら「どこかにこの引き出しの手がかりがある」メッセージ

### 3) 記録整列（`modal: sort-records`）
- 目的: 記録片16枚を並べ、文を成立させる（メタ1）
- UI:
  - 4列×4行（列: 記/録/雨/音、行: 1〜4）
  - 未所持スロットは空欄（薄い枠）
- 成功時:
  - 完成文を表示
  - ネガティブスペースの3桁（814）を表示（15の成果）
  - `shelfSorted=true`

### 4) 窓（`modal: window`）
- 条件: 布が必要
- UI:
  - 曇りレイヤ（`fx-fog.png`）を重ねる
  - 一定回数タップ/ドラッグで曇りが薄くなる
  - 完了で矢印列（表示: `↗ ↘ ↙` / 読む: 右から）を表示、`windowCleared=true`

### 5) レコーダー（`modal: recorder`）
- UI:
  - `再生` ボタン（短いビープ＋雨音の上で鳴る）
  - アクセシビリティ: 「短/長」テキスト列も同時に表示（任意）
- 成果:
  - 掲示板の符号表（9）で `20` に変換できるようになる

### 6) 掲示板（`modal: board`）
- UI:
  - 「短/長の4つ並び→数字」対応表（0〜9）
  - 例示として `短長短短=2` のような一行を置く（読める文字はUIなのでOK）

### 7) 秤（`modal: scale`）
- UI:
  - 4回の判定（軽い/重い）を並べる（上=1/下=0 など）
  - 結果が2進→10進（0〜15）になり、そのうち必要値だけ使う
- 成果:
  - 引き出し04のロック解錠（3）

### 8) 鏡（`item: mirror`）と小箱（`modal: case`）
- UI:
  - 鏡未所持: 反転した数字（例: `Ɛ9L` のような演出）で読めない
  - 鏡所持: 正しい数字（例: `319`）が読める
- 成果:
  - 赤フィルム取得、`hasRedFilm=true`

### 9) 瓶（`modal: bottles`）
- UI:
  - 5本の瓶を並び替え
  - 成功で `bottlesSolved=true`、テープ取得（or テープが見えるように）

### 10) 配電盤（`modal: panel`）
- 条件: プラグ所持
- UI:
  - 4つの差し込み口（色/記号）
  - ケーブルをドラッグで差し替え
- 成功:
  - `powerOn=true`、スタンドが点灯可能に

### 11) 電気スタンド（`modal: lamp`）
- 条件: `powerOn`
- UI:
  - 熱インク対象の紙を選択（`paper:heatInkTarget`）
- 成果:
  - 「台帳破片の貼り順」などのキー提示、`heatInkRevealed=true`

### 12) 台帳（`modal: desk`）
- UIタブ:
  - 台帳閲覧（ルール一覧、ただし欠落）
  - 破れ紙合成（6）
  - 台帳復元（16）: 破片×3＋テープ
- 成功:
  - `ledgerRestored=true`
  - 方向入力（17）の読み方
  - メタ2の変換規則（`月=時、日=分`）

### 13) 時計（`modal: clock`）
- UI:
  - 時/分のスライダ or 針ドラッグ
  - 「座標変換」用途（10）と「最終時刻」用途（メタ2）を同じUIで
- 成功条件:
  - `doorUnlocked=true` の後に `06:20` をセット→クリア

### 14) 扉（`modal: door`）
- UI:
  - 6桁入力
  - 部分一致のフィードバック（音＋表示）
- 成功:
  - `doorUnlocked=true`
