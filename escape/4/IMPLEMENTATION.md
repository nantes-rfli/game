# 脱出ゲーム #4 実装前メモ（設計確定）

## 1) 画面解像度・スケーリング方針
### 結論（推奨）
- 背景は `1536x1024`（3:2）
- 表示領域はCSSで `aspect-ratio: 3 / 2` を固定
- ホットスポットは **％指定（`--x --y --w --h`）** で管理
- 背景は `background-size: cover` を基本（余白が出ない）

理由:
- スマホ/PCで同じホットスポット定義を使える
- 画像差し替え時も座標が破綻しにくい

注意:
- `cover` は端が切れる可能性があるため、ホットスポットは「端ギリギリ」に置かない
- 端に重要ギミックがある構図は避ける（または `contain` 運用のシーンを別扱い）

---

## 2) データ駆動の基本方針
- 「シーン」「ホットスポット」「モーダル」「アイテム」をデータとして定義し、JSは汎用ロジック中心にする
- 文章（ログ/ヒント）はキー化して、後から差し替えやすくする（多言語化は将来でもOK）

---

## 3) 状態モデル（概要）
### シーン
- `record-room` / `hallway` / `storage` / `washroom`

### 主な状態
- 所持品: `inventory[]`
- 進行フラグ: `flags{...}`
- 引き出し: `drawers{ [01..16]: { opened, locked, lockType, solved } }`
- 記録片: `records{ "ki-1": true, ... }`（16枚）
- 文字/数字メモ: `notes{ arrows, date, audioDigits, doorProgress }`
- ヒントレベル: `hintLevel`（0〜2）

詳細は `escape/4/state.json` を参照。

---

## 4) UI仕様（最低限）
- ホットスポット: 背景上に透明ボタン（hoverで枠が出る）
- モーダル: 調査拡大/入力/合成/復元/クリアを共通コンポーネントで
- 下部パネル: インベントリ / ログ / ヒント（館内放送）

---

## 5) 実装順（推奨）
1. 4画面切替＋ホットスポット描画（仮座標）
2. インベントリ/ログ/モーダルの共通UI
3. 引き出しUI（4×4一覧→個別）
4. 小謎（布/窓、鏡、小箱、瓶、レコーダー）
5. 配電盤→通電→熱インク
6. 台帳復元→方向入力→出口ロック→時計メタ

